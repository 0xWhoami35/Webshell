<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add Text to File</title>
</head>
<body>
    <h1>Add Text to File</h1>
    <form method="post">
        <label for="directory">Directory Path:</label><br>
        <input type="text" id="directory" name="directory" required><br>
        <label for="filename">Filename:</label><br>
        <input type="text" id="filename" name="filename" required><br>
        <label for="newtext">New Text:</label><br>
        <textarea id="newtext" name="newtext" rows="4" cols="50" required></textarea><br>
        <input type="submit" value="Add Text">
    </form>

    <?php
    // Handle form submission
    if ($_SERVER['REQUEST_METHOD'] == 'POST') {
        // Validate inputs
        $directory = isset($_POST['directory']) ? $_POST['directory'] : '';
        $filename = isset($_POST['filename']) ? $_POST['filename'] : '';
        $newtext = isset($_POST['newtext']) ? $_POST['newtext'] : '';

        if (!empty($directory) && !empty($filename) && !empty($newtext)) {
            // Construct the file path
            $filepath = rtrim($directory, '/') . '/' . $filename;

            // Open the file in append mode ('a')
            $appendVar = fopen($filepath, 'a');

            // Check if file opened successfully
            if ($appendVar) {
                // Write new lines to the file
                $wit1 = fwrite($appendVar, "\n"); // Ensure new line before new text
                $wit2 = fwrite($appendVar, $newtext);

                // Close the file
                fclose($appendVar);

                // Check if writing was successful
                if ($wit1 !== false && $wit2 !== false) {
                    echo "<p>Text added to file successfully.</p>";
                } else {
                    echo "<p>Failed to add text to file.</p>";
                }
            } else {
                echo "<p>Failed to open file: $filepath</p>";
            }
        } else {
            echo "<p>Please fill out all fields.</p>";
        }
    }
    ?>
</body>
</html>
